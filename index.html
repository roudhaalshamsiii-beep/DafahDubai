<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Dafah Dubai · In Bloom, At Rest</title>
  <style>
    :root{ --bg1:#F3EFE9; --bg2:#E9E3DC; --ink:#4a4a4a; --maxW:960px; --pad:14px; }
    html,body{height:100%;margin:0}
    body{
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; color:var(--ink);
      background:
        radial-gradient(1200px 700px at 50% -200px,#f8f5f0 0%,transparent 60%),
        linear-gradient(var(--bg1),var(--bg2));
      display:flex; flex-direction:column; align-items:center; min-height:100svh;
    }
    header{text-align:center;padding:18px 12px 10px}
    h1{margin:0;font-size:18px;letter-spacing:.10em;font-weight:600}
    .sub{margin:6px 0 0;font-size:13px;letter-spacing:.06em;opacity:.7}

    .stage{flex:1;width:100%;display:grid;place-items:center;padding:14px 0 24px;box-sizing:border-box;overflow:auto;-webkit-overflow-scrolling:touch}
    .paper{width:min(var(--maxW),94vw);background:#fff;border-radius:8px;box-shadow:0 18px 54px rgba(0,0,0,.14);padding:var(--pad);box-sizing:border-box}
    .page{display:block;width:100%;margin:0 auto 14px;background:#fff;border-radius:6px;box-shadow:0 2px 10px rgba(0,0,0,.06)}
    .loading{height:4px;border-radius:999px;background:#ffffffa6;box-shadow:0 10px 24px rgba(0,0,0,.08);overflow:hidden;width:min(420px,70vw);margin:18px auto 0}
    .loading::before{content:"";display:block;height:100%;width:40%;background:linear-gradient(90deg,#e6e1da,#fff,#e6e1da);animation:slide 1.2s linear infinite}
    @keyframes slide{from{transform:translateX(-40%)}to{transform:translateX(140%)}}
    .error{color:#a33;text-align:center;padding:18px;font-size:14px}
    @media (max-width:768px){ h1{font-size:16px}.sub{font-size:12px}.paper{width:96vw} }
  </style>
</head>
<body>
  <header>
    <h1>IN BLOOM, AT REST</h1>
    <div class="sub">Dafah Dubai · Lookbook 2025</div>
    <div id="bar" class="loading" aria-hidden="true"></div>
  </header>

  <main class="stage">
    <div id="viewer" class="paper" aria-live="polite"></div>
  </main>

  <!-- pdf.js (UMD build) -->
  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc =
      "https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js";

    const PDF_NAME = "DafahDubaiLookbook2025.pdf"; // exact filename
    const viewer = document.getElementById("viewer");
    const bar = document.getElementById("bar");

    async function renderPDF(){
      try{
        viewer.innerHTML = "";
        const pdf = await pdfjsLib.getDocument(PDF_NAME).promise;

        // Render pages at device pixel ratio for crispness (cap to avoid huge memory)
        const dpr = Math.min(window.devicePixelRatio || 1, 2.5); // Retina sharp, safe on iPhone

        for (let i = 1; i <= pdf.numPages; i++){
          const page = await pdf.getPage(i);
          const unscaled = page.getViewport({ scale: 1 });

          // Fit to paper width (account inner padding ~2*var(--pad))
          const style = getComputedStyle(viewer);
          const innerPad = parseInt(style.paddingLeft) + parseInt(style.paddingRight);
          const cssTargetW = Math.max(240, viewer.clientWidth - innerPad); // CSS pixels
          const renderScale = (cssTargetW * dpr) / unscaled.width;         // device pixels
          const viewport = page.getViewport({ scale: renderScale });

          // Canvas at device-pixel size, but display at CSS width for sharpness
          const canvas = document.createElement("canvas");
          canvas.className = "page";
          canvas.width  = Math.ceil(viewport.width);
          canvas.height = Math.ceil(viewport.height);
          canvas.style.width  = cssTargetW + "px";
          canvas.style.height = Math.round(viewport.height / dpr) + "px";

          const ctx = canvas.getContext("2d", { alpha:false });
          ctx.imageSmoothingEnabled = true;
          await page.render({ canvasContext: ctx, viewport }).promise;

          viewer.appendChild(canvas);
          if (bar) bar.style.width = Math.min(100, (i/pdf.numPages)*100) + "%";
        }
      }catch(err){
        console.error(err);
        viewer.innerHTML =
          '<div class="error">Couldn’t load <strong>DafahDubaiLookbook2025.pdf</strong>. Make sure it’s next to index.html and the name matches exactly.</div>';
      }finally{
        if (bar) bar.style.display = "none";
      }
    }

    renderPDF();

    // Re-render on rotate/resize so pages stay sharp and centered
    let t;
    addEventListener("resize", () => { clearTimeout(t); t = setTimeout(renderPDF, 160); });
  </script>
</body>
</html>
